<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Work Simulator</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <h1>Level 5-4</h1>
    <p>Bob's Boss gets so riled up about doing "some other important work" that he transforms into... ANGRY BOSS!!!!!</p>
    <p>Press the button to run away from ANGRY BOSS!</p>
    <button onclick="run()">Run Away</button>
    <p id="bossBar">🏃=========👿</p>
    <p id="levelEndText" hidden>*huff puff* Oh yeah, did I mention Bob's Boss's office is on a treadmill? No? Sorry about that.</p>
    <h2 id="moral" hidden>The Moral: Don't create endless levels. (Unless the gamemode specifically says, "Endless".)</h2>
    <button id="next" onclick="window.location.href='/stage6-1.html'" hidden>Next</button>

    <script>
      var started = false;
      var position = 10;
      var timeout;
      
      function run() {
        if (position > 0) position += 3;
        if (position > 10) position = 10;
        update();
        if (!started) {
          var interval = setInterval(function() {
            position--;
            update();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
            document.getElementById("levelEndText").hidden = false;
            document.getElementById("moral").hidden = false;
            document.getElementById("next").hidden = false;
          }, 7500);
          started = true;
        }
      }

      function update() {
        let text = "";
        for (let i = 10; i > 0; i--) {
          if (i == position) text += "🏃‍♂️";
          else text += "=";
        }

        text+="👿";

        if (position <= 0) {
          text = "😈 You were caught by ANGRY BOSS! Try again by pressing Ctrl-R!";
          clearTimeout(timeout);
        }
        document.getElementById("bossBar").innerText = text;
      }
    </script>
  </body>
</html>